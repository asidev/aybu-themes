Ext.ns("TreeManager");TreeManager.BaseStore=Ext.extend(Ext.data.JsonStore,{constructor:function(a){if(!a){a={}}TreeManager.BaseStore.superclass.constructor.call(this,Ext.apply(a,{writer:new Ext.data.JsonWriter({encode:true,listful:true,writeAllFields:true}),autoSave:false,remoteSort:true}));this.addListener("exception",this.exception_handler,this);this.addListener("update",this.update_handler,this);this.addListener("save",this.save_handler,this);this.reload_after_write=false},defaultLoad:function(a){var b={start:0,meta:1};if(this.pageSize){b.limit=this.pageSize}this.defaultOpts={params:b};Ext.apply(this.defaultOpts,a);this.load(this.defaultOpts)},exception_handler:function(c,d,e,a,b){if(d==="remote"){Ext.Msg.show({title:"Richiesta Fallita",msg:"Risposta del server : "+b.raw.message,icon:Ext.MessageBox.ERROR,buttons:Ext.Msg.OK})}else{if(d=="response"){Ext.Msg.show({title:"REMOTE EXCEPTION",msg:"Internal Server Error ("+b.status+"): "+b.responseText,icon:Ext.MessageBox.ERROR,buttons:Ext.Msg.OK})}}this.rejectChanges()},update_handler:function(c,a,b){if(b==Ext.data.Record.EDIT){this.save()}},save_handler:function(a,b,c){if(Ext.Msg.isVisible()){Ext.Msg.hide()}if(this.reload_after_write==true){this.reload();this.reload_after_write=false}}});