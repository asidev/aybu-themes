(function(n){var a=null;var d="",e="";var f=this;var o=false;var g=false;var j=null;var m=new Array();var k=new Array();var b=0;var c=false;var h=new Array();n.fn.bgStretcher=function(r){if(n(".bgstretcher-page").length||n(".bgstretcher-area").length){if(typeof(console)!=="undefined"&&console!=null){console.log("More than one bgStretcher")}return false}r=n.extend({},n.fn.bgStretcher.defaults,r);n.fn.bgStretcher.settings=r;function q(v){if(!r.images.length){return}p(v);e="#"+r.imageContainer;a=n(e);d="#"+r.imageContainer+" LI";n(d).hide().css({"z-index":1,overflow:"hidden"});if(!a.length){return}n(window).resize(function(){s(v)});s(v);var w=0;if(r.transitionEffect=="simpleSlide"){if(r.sequenceMode=="random"){if(typeof(console)!=="undefined"&&console!=null){console.log("Effect 'simpleSlide' don't be to use with mode random.");console.log("Mode was automaticly set in normal.")}}n(d).css({"float":"left",position:"static"});n(d).show();if(n.fn.bgStretcher.settings.slideDirection=="NW"||n.fn.bgStretcher.settings.slideDirection=="NE"){n.fn.bgStretcher.settings.slideDirection="N"}if(n.fn.bgStretcher.settings.slideDirection=="SW"||n.fn.bgStretcher.settings.slideDirection=="SE"){n.fn.bgStretcher.settings.slideDirection="S"}if(n.fn.bgStretcher.settings.slideDirection=="S"||n.fn.bgStretcher.settings.slideDirection=="E"){r.sequenceMode="back";n(d).removeClass("bgs-current");n(d).eq(n(d).length-n.fn.bgStretcher.settings.startElementIndex-1).addClass("bgs-current");if(n.fn.bgStretcher.settings.slideDirection=="E"){l=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).width()*(-1);t=0}else{t=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).height()*(-1);l=0}n(e+" UL").css({left:l+"px",top:t+"px"})}else{r.sequenceMode="normal";if(n.fn.bgStretcher.settings.startElementIndex!=0){if(n.fn.bgStretcher.settings.slideDirection=="N"){t=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).height()*(-1);l=0}else{l=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).width()*(-1);t=0;console.log(l)}n(e+" UL").css({left:l+"px",top:t+"px"})}}}if(n(r.buttonNext).length||n(r.buttonPrev).length||n(r.pagination).length){if(r.sequenceMode=="random"){if(typeof(console)!=="undefined"&&console!=null){console.log("Don't use random mode width prev-button, next-button and pagination.")}}else{if(n(r.buttonPrev).length){n(r.buttonPrev).addClass("bgStretcherNav bgStretcherNavPrev");n(r.buttonPrev).click(function(){n.fn.bgStretcher.buttonSlide("prev")})}if(n(r.buttonNext).length){n(r.buttonNext).addClass("bgStretcherNav bgStretcherNavNext");n(r.buttonNext).click(function(){n.fn.bgStretcher.buttonSlide("next")})}if(n(r.pagination).length){n.fn.bgStretcher.pagination()}}}if(r.sequenceMode=="random"){var u=Math.floor(Math.random()*n(d).length);n.fn.bgStretcher.buildRandom(u);if(r.transitionEffect!="simpleSlide"){n.fn.bgStretcher.settings.startElementIndex=u}w=u}else{if(n.fn.bgStretcher.settings.startElementIndex>(n(d).length-1)){n.fn.bgStretcher.settings.startElementIndex=0}w=n.fn.bgStretcher.settings.startElementIndex;if(r.transitionEffect=="simpleSlide"){if(n.fn.bgStretcher.settings.slideDirection=="S"||n.fn.bgStretcher.settings.slideDirection=="E"){w=n(d).length-1-n.fn.bgStretcher.settings.startElementIndex}}}n(d).eq(w).show().addClass("bgs-current");n.fn.bgStretcher.loadImg(n(d).eq(w));if(r.slideShow&&n(d).length>1){j=setTimeout("jQuery.fn.bgStretcher.slideShow('"+n.fn.bgStretcher.settings.sequenceMode+"', -1)",r.nextSlideDelay)}}function s(D){var F=0;var y=0;var H=0;var v=0;if(n("BODY").hasClass("bgStretcher-container")){F=n(window).width();y=n(window).height();if((n.browser.msie)&&(parseInt(n.browser.version)==6)){n(window).scroll(function(){n("#"+r.imageContainer).css("top",n(window).scrollTop())})}}else{n(".bgstretcher").css("position","absolute").css("top","0px");F=D.width();y=D.height()}var E=0,x=0;var w=0;if(r.maxWidth!="auto"){if(F>r.maxWidth){w=(F-r.maxWidth)/2;v=r.maxWidth}else{v=F}}else{v=F}if(r.maxHeight!="auto"){if(y>r.maxHeight){H=r.maxHeight}else{H=y}}else{H=y}a.width(v);a.height(H);if(!r.resizeProportionally){E=H;x=H}else{var G=r.imageWidth,B=r.imageHeight;var C=B/G;E=v;x=Math.round(v*C);if(x<H){x=H;E=Math.round(x/C)}}var u=0;var J=0;var I;if(n.fn.bgStretcher.settings.anchoring!="left top"){I=(n.fn.bgStretcher.settings.anchoring).split(" ");if(I[0]=="right"){u=(F-v)}else{if(I[0]=="center"){u=Math.round((F-v)/2)}}if(I[1]=="bottom"){J=(y-H)}else{if(I[1]=="center"){J=Math.round((y-H)/2)}}a.css("marginLeft",u+"px").css("marginTop",J+"px")}u=0;J=0;if(n.fn.bgStretcher.settings.anchoringImg!="left top"){I=(n.fn.bgStretcher.settings.anchoringImg).split(" ");if(I[0]=="right"){u=(v-E)}else{if(I[0]=="center"){u=Math.round((v-E)/2)}}if(I[1]=="bottom"){J=(H-x)}else{if(I[1]=="center"){J=Math.round((H-x)/2)}}}h.mar_left=u;h.mar_top=J;if(a.find("LI:first").hasClass("swf-mode")){var z=a.find("LI:first").html();a.find("LI:first").html('<div id="bgstretcher-flash">&nbsp;</div>');var A=new SWFObject("flash/stars.swf","flash-obj",v,H,"9");A.addParam("wmode","transparent");A.write("bgstretcher-flash")}h.imgW=E;h.imgH=x;if(!r.resizeAnimate){a.children("UL").children("LI.img-loaded").find("IMG").css({marginLeft:h.mar_left+"px",marginTop:h.mar_top+"px"});a.children("UL").children("LI.img-loaded").find("IMG").css({width:h.imgW+"px",height:h.imgH+"px"})}else{a.children("UL").children("LI.img-loaded").find("IMG").animate({marginLeft:h.mar_left+"px",marginTop:h.mar_top+"px"},"normal");a.children("UL").children("LI.img-loaded").find("IMG").animate({width:h.imgW+"px",height:h.imgH+"px"},"normal")}n(d).width(a.width()).height(a.height());if(n.fn.bgStretcher.settings.transitionEffect=="simpleSlide"){if(n.fn.bgStretcher.settings.slideDirection=="W"||n.fn.bgStretcher.settings.slideDirection=="E"){a.children("UL").width(a.width()*n(d).length).height(a.height());if(n(e+" LI").index(n(e+" LI.bgs-current"))!=-1){l=n(e+" LI").index(n(e+" LI.bgs-current"))*a.width()*(-1);a.children("UL").css({left:l+"px"})}}else{a.children("UL").height(a.height()*n(d).length).width(a.width());if(n(e+" LI").index(n(e+" LI.bgs-current"))!=-1){t=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).height()*(-1);a.children("UL").css({top:t+"px"})}}}}function p(u){var v="";var w;u.each(function(){n(this).wrapInner('<div class="bgstretcher-page" />').wrapInner('<div class="bgstretcher-area" />');v='<div id="'+r.imageContainer+'" class="bgstretcher"><ul>';if(r.images.length){var x=r.images[0].split(".");x=x[x.length-1];if(x!="swf"){var y=0;for(i=0;i<r.images.length;i++){if(r.transitionEffect=="simpleSlide"&&r.sequenceMode=="back"){y=r.images.length-1-i}else{y=i}if(n.fn.bgStretcher.settings.preloadImg){v+='<li><span class="image-path">'+r.images[y]+"</span></li>"}else{v+='<li class="img-loaded"><img src="'+r.images[y]+'" alt="" /></li>'}}}else{v+='<li class="swf-mode">'+r.images[0]+"</li>"}}v+="</ul></div>";w=n(this).children(".bgstretcher-area");n(v).prependTo(w);w.css({position:"relative"});w.children(".bgstretcher-page").css({position:"relative","z-index":3})})}this.addClass("bgStretcher-container");q(this)};n.fn.bgStretcher.loadImg=function(p){if(p.hasClass("img-loaded")){return true}p.find("SPAN.image-path").each(function(){var u=n(this).html();var s="";var r=n(this).parent();var q=new Image();n(q).load(function(){n(this).hide();r.prepend(this);n(this).fadeIn("100")}).error(function(){}).attr("src",u).attr("alt",s);n(q).css({marginLeft:h.mar_left+"px",marginTop:h.mar_top+"px"});n(q).css({width:h.imgW+"px",height:h.imgH+"px"})});p.addClass("img-loaded");return true};n.fn.bgStretcher.play=function(){o=false;n.fn.bgStretcher._clearTimeout();n.fn.bgStretcher.slideShow(n.fn.bgStretcher.settings.sequenceMode,-1)};n.fn.bgStretcher._clearTimeout=function(){if(j!=null){clearTimeout(j);j=null}};n.fn.bgStretcher.pause=function(){o=true;n.fn.bgStretcher._clearTimeout()};n.fn.bgStretcher.sliderDestroy=function(){var p=n(".bgstretcher-page").html();n(".bgStretcher-container").html("").html(p).removeClass("bgStretcher-container");n.fn.bgStretcher._clearTimeout();o=false};n.fn.bgStretcher.slideShow=function(p,q){g=true;if(n(d).length<2){return true}var s=n(e+" LI.bgs-current");var r;if(q==-1){switch(p){case"back":r=s.prev();if(!r.length){r=n(e+" LI:last")}break;case"random":if(b==n(e+" LI").length){n.fn.bgStretcher.buildRandom(m[n(e+" LI").length-1]);b=0}r=n(e+" LI").eq(m[b]);b++;break;default:r=s.next();if(!r.length){r=n(e+" LI:first")}}}else{r=n(e+" LI").eq(q)}n(e+" LI").removeClass("bgs-current");n.fn.bgStretcher.loadImg(r);r.addClass("bgs-current");switch(n.fn.bgStretcher.settings.transitionEffect){case"fade":n.fn.bgStretcher.effectFade(s,r);break;case"simpleSlide":n.fn.bgStretcher.simpleSlide();break;case"superSlide":n.fn.bgStretcher.superSlide(s,r,p);break;default:n.fn.bgStretcher.effectNone(s,r)}if(n(n.fn.bgStretcher.settings.pagination).find("LI").length){n(n.fn.bgStretcher.settings.pagination).find("LI.showPage").removeClass("showPage");n(n.fn.bgStretcher.settings.pagination).find("LI").eq(n(e+" LI").index(n(e+" LI.bgs-current"))).addClass("showPage")}if(n.fn.bgStretcher.settings.callbackfunction){if(typeof n.fn.bgStretcher.settings.callbackfunction=="function"){n.fn.bgStretcher.settings.callbackfunction.call()}}if(!o){j=setTimeout("jQuery.fn.bgStretcher.slideShow('"+n.fn.bgStretcher.settings.sequenceMode+"', -1)",n.fn.bgStretcher.settings.nextSlideDelay)}};n.fn.bgStretcher.effectNone=function(q,p){p.show();q.hide();g=false};n.fn.bgStretcher.effectFade=function(q,p){p.fadeIn(n.fn.bgStretcher.settings.slideShowSpeed);q.fadeOut(n.fn.bgStretcher.settings.slideShowSpeed,function(){g=false})};n.fn.bgStretcher.simpleSlide=function(){var q,p;switch(n.fn.bgStretcher.settings.slideDirection){case"N":case"S":q=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).height()*(-1);p=0;break;default:p=n(e+" LI").index(n(e+" LI.bgs-current"))*n(e).width()*(-1);q=0}n(e+" UL").animate({left:p+"px",top:q+"px"},n.fn.bgStretcher.settings.slideShowSpeed,function(){g=false})};n.fn.bgStretcher.superSlide=function(u,s,p){var r,q;switch(n.fn.bgStretcher.settings.slideDirection){case"S":r=n(e).height();q=0;break;case"E":r=0;q=n(e).width();break;case"W":r=0;q=n(e).width()*(-1);break;case"NW":r=n(e).height()*(-1);q=n(e).width()*(-1);break;case"NE":r=n(e).height()*(-1);q=n(e).width();break;case"SW":r=n(e).height();q=n(e).width()*(-1);break;case"SE":r=n(e).height();q=n(e).width();break;default:r=n(e).height()*(-1);q=0}if(p=="back"){s.css({"z-index":2,top:r+"px",left:q+"px"});s.show();s.animate({left:"0px",top:"0px"},n.fn.bgStretcher.settings.slideShowSpeed,function(){u.hide();n(this).css({"z-index":1});g=false})}else{u.css("z-index",2);s.show();u.animate({left:q+"px",top:r+"px"},n.fn.bgStretcher.settings.slideShowSpeed,function(){n(this).hide().css({"z-index":1,top:"0px",left:"0px"});g=false})}};n.fn.bgStretcher.buildRandom=function(u){var q=n(d).length;var s,r,p;for(s=0;s<q;s++){m[s]=s;k[s]=Math.random()*q}for(s=0;s<q;s++){for(r=0;r<(q-s-1);r++){if(k[r]>k[r+1]){p=k[r];k[r]=k[r+1];k[r+1]=p;p=m[r];m[r]=m[r+1];m[r+1]=p}}}if(m[0]==u){p=m[0];m[0]=m[q-1];m[q-1]=p}};n.fn.bgStretcher.buttonSlide=function(p){if(g||(n(d).length<2)){return false}var q="";if(p=="prev"){q="back";if(n.fn.bgStretcher.settings.sequenceMode=="back"){q="normal"}}else{q=n.fn.bgStretcher.settings.sequenceMode}n(d).stop(true,true);n.fn.bgStretcher._clearTimeout();n.fn.bgStretcher.slideShow(q,-1);return false};n.fn.bgStretcher.pagination=function(){var p=n(d).length;var q="";var r=0;if(p>0){q+="<ul>";for(r=0;r<p;r++){q+='<li><a href="javascript:;">'+(r+1)+"</a></li>"}q+="</ul>";n(n.fn.bgStretcher.settings.pagination).html(q);n(n.fn.bgStretcher.settings.pagination).find("LI:first").addClass("showPage");n(n.fn.bgStretcher.settings.pagination).find("A").click(function(){if(n(this).parent().hasClass("showPage")){return false}n(d).stop(true,true);n.fn.bgStretcher._clearTimeout();n.fn.bgStretcher.slideShow(n.fn.bgStretcher.settings.sequenceMode,n(n.fn.bgStretcher.settings.pagination).find("A").index(n(this)));return false})}return false};n.fn.bgStretcher.defaults={imageContainer:"bgstretcher",resizeProportionally:true,resizeAnimate:false,images:[],imageWidth:1024,imageHeight:768,maxWidth:"auto",maxHeight:"auto",nextSlideDelay:3000,slideShowSpeed:"normal",slideShow:true,transitionEffect:"fade",slideDirection:"N",sequenceMode:"normal",buttonPrev:"",buttonNext:"",pagination:"",anchoring:"left top",anchoringImg:"left top",preloadImg:false,startElementIndex:0,callbackfunction:null};n.fn.bgStretcher.settings={}})(jQuery);