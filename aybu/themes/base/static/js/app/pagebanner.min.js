Ext.ns("Aybu.PageBanner");Aybu.PageBanner.Window=Ext.extend(Aybu.Base.Window,{constructor:function(a){this.page_id=a.page_id;Aybu.PageBanner.Window.superclass.constructor.call(this,a)},initComponent:function(){var a={title:"Gestione Banner Pagina",width:180,items:{xtype:"AybuBasePanel",id:"images-view",enableDD:true,tbar:{buttonsCfg:{add:true,delete_:true},changeDisabledButtons:function(b){if(b.length){this.getComponent("deleteButton").setDisabled(false)}else{this.getComponent("deleteButton").setDisabled(true)}}},items:{xtype:"AybuBaseDataView",emptyText:'<div class="plupload_emptytext"><span>Nessun banner di pagina.</span></div>',tpl:new Ext.XTemplate('<tpl for=".">','<tpl for="banner">','<div class="thumb-wrap default_banner_{default}" id="{id}">','<div class="thumb">','<img src="{url}" alt="{name}" title="{name}">',"</div>",'<span class="name x-editable"><b>{short_name}</b></span></div>',"</tpl>","</tpl>",'<div class="x-clear"></div>'),store:{xtype:"AybuBaseStore",httpProxyUrl:"/admin/pagebanner/"+this.page_id+"",fields:["page","banner",{name:"weight",type:"int"}],sortInfo:{field:"weight",direction:"ASC"}}},addWindow:new Aybu.Banner.Window(),onSelectionDone:function(e){var b=this.getComponent(0);var d=b.getStore();var c=[];for(i=0;i<e.length;i++){var f=new d.recordType({page:this.page_id,banner:{id:e[i].data.id,name:e[i].data.name,url:e[i].data.url}});c.push(f)}d.add(c);d.save()}}};Ext.apply(this,Ext.apply(this.initialConfig,a));Aybu.PageBanner.Window.superclass.initComponent.apply(this,arguments)},onDataChange:function(j,g,e){var a=this.getComponent(0);var h=a.getComponent(0);var j=h.getStore();var c=j.getRange();var d=jQuery(jQuery.aybu.pageBannerSelector).bgStretcher.settings;d.images=[];for(var f=0;f<c.length;f++){var b=c[f].data.banner.url;d.images.push(b)}jQuery(jQuery.aybu.pageBannerSelector).bgStretcher.sliderDestroy();jQuery(jQuery.aybu.pageBannerSelector).bgStretcher(d)}});Ext.reg("AybuPageBannerWindow",Aybu.PageBanner.Window);