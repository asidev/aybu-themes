Ext.ns("settings");settings.SettingForm=Ext.extend(Ext.form.FormPanel,{constructor:function(a){this.win=a.win;this.setting=a.setting;a.defaults={anchor:"90%",};this.waitMsg="Salvo...";this.submit_url=urls.create;this.related=[];settings.SettingForm.superclass.constructor.call(this,a)},initComponent:function(){var b={layout:"form",padding:10,labelWidth:80};var a=new Ext.form.TextField({id:"name",name:"name",readOnly:true,fieldLabel:"Nome",allowBlank:false});var c=null;if(this.setting.setting_type_name=="html"){c=new Ext.form.HtmlEditor({id:"value",name:"value",fieldLabel:"Valore",allowBlank:false,enableLists:false})}else{if(this.setting.raw_type=="int"){c=new Ext.form.NumberField({id:"value",name:"value",fieldLabel:"Valore",allowBlank:false})}else{if(this.setting.setting_type_name=="txt"||this.setting.setting_type_name=="image"||this.setting.setting_type_name=="email"){c=new Ext.form.TextField({id:"value",name:"value",fieldLabel:"Valore",allowBlank:true})}else{if(this.setting.setting_type_name=="checkbox"){c=new Ext.form.Checkbox({id:"value",name:"value",fieldLabel:"Valore",allowBlank:false})}else{c=new Ext.form.TextField({id:"value",name:"value",fieldLabel:"Valore",allowBlank:false,})}}}}this.items=[a,c];this.buttons=[{id:"reset",text:"Reset",handler:this.reset,scope:this},{id:"submit",text:"Salva",handler:this.submit,scope:this}];Ext.apply(this,Ext.apply(this.initialConfig,b));settings.SettingForm.superclass.initComponent.call(this,arguments)},reset:function(){this.getForm().reset();if(this.original_setting){this.getForm().setValues({name:this.original_setting.name,value:this.original_setting.value})}},submit:function(){this.getForm().submit({url:this.submit_url,success:this.submit_success,failure:this.submit_failure,scope:this,clientValidation:true,waitMsg:this.waitMsg})},submit_success:function(a,b){Ext.Msg.show({title:"Impostazione Salvata",msg:"Impostazione salvata con successo.",icon:Ext.MessageBox.INFO,buttons:Ext.Msg.OK,fn:this.reload_window})},reload_window:function(){window.location.reload(true)},submit_failure:function(a,b){switch(b.failureType){case Ext.form.Action.CLIENT_INVALID:Ext.Msg.alert("Validazione","Errore di validazione dei campi");break;default:Ext.Msg.alert("Richiesta fallita",b.result.errors.exception);break}},load:function(a){this.name=a.name;this.setting=a;this.original_setting=a;this.getForm().setValues({name:a.name,value:a.value})},setUpdate:function(a){this.waitMsg="Aggiorno...";this.submit_url=urls.update;this.enable()}});