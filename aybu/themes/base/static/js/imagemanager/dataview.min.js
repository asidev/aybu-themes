Ext.ns("imgmanager");var image_tpl=new Ext.XTemplate('<tpl for=".">','<div class="thumb-wrap" id="{id}">','<div class="thumb"><img src="{thumb_url}" alt="{name}" title="{name} - [{size_string}]"></div>','<span class="name x-editable"><b>{short_name}</b></span></div>',"</tpl>",'<div class="x-clear"></div>');function filter_dataview(a){search_field.enable();imgmanager.dataview.getStore().filter("name",a,true,false);resize_thumbs()}imgmanager.dataview=new Ext.DataView({region:"center",multiSelect:true,overClass:"x-view-over",autoHeight:true,itemSelector:"div.thumb-wrap",emptyText:"<div class='plupload_emptytext'><span>Nessuna immagine disponibile</span></div>",store:imgmanager.image_store,tpl:image_tpl,plugins:[new Ext.DataView.DragSelector(),new Ext.DataView.LabelEditor({dataIndex:"name"})],prepareData:function(a){a.short_name=Ext.util.Format.ellipsis(a.name,15);a.size_string=Ext.util.Format.fileSize(a.size);return a},listeners:{selectionChange:function(a,b){if(b.length){toolbar=imgmanager.image_panel.getTopToolbar();if(b.length==1){toolbar.getComponent("edit").setDisabled(false);toolbar.getComponent("select").setDisabled(false)}else{toolbar.getComponent("edit").setDisabled(true);toolbar.getComponent("select").setDisabled(true)}toolbar.getComponent("delete").setDisabled(false)}else{toolbar.getComponent("delete").setDisabled(true);toolbar.getComponent("edit").setDisabled(true);toolbar.getComponent("select").setDisabled(true)}},dblclick:function(c,a,d,b){var f=this.getSelectedRecords()[0].json;var e=new Ext.Window({closeAction:"hide",plain:true,layout:"fit",width:f.width+20,height:f.height+100,items:[new Ext.Panel({title:f.name,width:f.width,height:f.height,html:'<img src="'+f.url+'"/>'})]});e.show()}}});imgmanager.keymap=new Ext.KeyMap(document,{key:"a",ctrl:true,stopEvent:true,scope:imgmanager.dataview,handler:function(){this.selectRange(0,this.getNodes().length)}});